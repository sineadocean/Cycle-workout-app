<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cycle-Aware Workout Tracker</title>
<style>
  body { font-family: sans-serif; padding: 10px; margin:0; background: #f5f5f5; }
  h1, h2 { text-align: center; margin: 10px 0; }
  #calendar { display: flex; flex-direction: column; gap: 10px; }
  .day { padding: 15px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
  .today { border: 3px solid #ff4c4c; background: #fff3f0 !important; }
  .menstrual { background: #f4c7c3; }
  .follicular { background: #b6e3a9; }
  .ovulation { background: #fddb7d; }
  .early-luteal { background: #a0d8f1; }
  .late-luteal { background: #c9c9c9; }
  .workouts { margin-top: 8px; font-size: 16px; }
  input[type="checkbox"] { margin-right: 10px; transform: scale(1.3); }
  .notes { margin-top: 8px; width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
  label { display: block; margin: 4px 0; }
  input[type="date"], button { padding: 10px; font-size: 16px; margin: 5px 0; width: 100%; box-sizing: border-box; border-radius: 8px; border: 1px solid #ccc; }
  button { background: #4caf50; color: white; border: none; cursor: pointer; }
  button:hover { background: #45a049; }
</style>
</head>
<body>

<h1>Cycle-Aware Workout Tracker</h1>
<h2 id="todayInfo"></h2>

<label>Cycle Start Date: <input type="date" id="startDate"></label>
<button onclick="generateCycle()">Generate Cycle</button>

<div id="calendar"></div>

<script>
// Define personal cycle phases
const phaseRules = [
  { name: 'Menstrual', start: 1, end: 6, workouts: ['Pilates', 'Walk'] },
  { name: 'Follicular', start: 7, end: 9, workouts: ['Weights', 'Incline Walking'] },
  { name: 'Ovulation', start: 10, end: 14, workouts: ['Weights', 'Incline Walking', 'Pilates'] },
  { name: 'Early Luteal', start: 15, end: 21, workouts: ['Weights', 'Incline Walking'] },
  { name: 'Late Luteal', start: 22, end: 28, workouts: ['Pilates', 'Incline Walking'] }
];

// Weekly schedule
const weeklyConstraints = {
  1: 'Gym', 2: 'Ballet', 3: 'Walk', 4: 'At-home Workout', 5: 'Flexible', 6: 'Flexible', 0: 'Flexible'
};

// Load saved cycle start date
window.onload = () => {
  const savedDate = localStorage.getItem('cycleStartDate');
  if (savedDate) {
    document.getElementById('startDate').value = savedDate;
    generateCycle();
  }
}

function generateCycle() {
  const startDateInput = document.getElementById('startDate').value;
  if (!startDateInput) return alert('Please select a start date!');

  localStorage.setItem('cycleStartDate', startDateInput);

  const [year, month, day] = startDateInput.split('-').map(Number);
  const startDate = new Date(year, month - 1, day);

  const calendarDiv = document.getElementById('calendar');
  calendarDiv.innerHTML = '';

  const today = new Date();
  let todayCycleDay = null;
  let todayPhase = null;

  for (let i = 0; i < 28; i++) {
    const dayDate = new Date(startDate);
    dayDate.setDate(dayDate.getDate() + i);

    const phase = phaseRules.find(p => (i + 1) >= p.start && (i + 1) <= p.end);

    if (dayDate.toDateString() === today.toDateString()) {
      todayCycleDay = i + 1;
      todayPhase = phase.name;
    }

    const dayDiv = document.createElement('div');
    dayDiv.className = `day ${phase.name.toLowerCase().replace(' ', '-')}`;
    if (dayDate.toDateString() === today.toDateString()) dayDiv.classList.add('today');

    const weekday = dayDate.getDay();
    let workoutHtml = '';

    if (weeklyConstraints[weekday] === 'Ballet') {
      workoutHtml += `<strong>Ballet class</strong><br>`;
    } else if (weeklyConstraints[weekday] === 'Gym') {
      phase.workouts.forEach(w => workoutHtml += `<label><input type="checkbox"> ${w}</label><br>`);
    } else if (weeklyConstraints[weekday] === 'At-home Workout') {
      if (phase.workouts.includes('Pilates')) workoutHtml += `<label><input type="checkbox"> Pilates</label><br>`;
      if (phase.workouts.includes('Incline Walking')) workoutHtml += `<label><input type="checkbox"> Walk</label><br>`;
    } else {
      phase.workouts.forEach(w => workoutHtml += `<label><input type="checkbox"> ${w}</label><br>`);
    }

    dayDiv.innerHTML = `<strong>Day ${i + 1} (${phase.name}) - ${dayDate.toDateString()}</strong>
                        <div class="workouts">${workoutHtml}</div>
                        <textarea class="notes" placeholder="Notes about energy/fatigue..."></textarea>`;

    calendarDiv.appendChild(dayDiv);
  }

  // Scroll to today
  const todayElement = document.querySelector('.today');
  if (todayElement) todayElement.scrollIntoView({ behavior: 'smooth', block: 'center' });

  if (todayCycleDay && todayPhase) {
    document.getElementById('todayInfo').textContent =
      `Today is ${today.toDateString()} â€” Cycle Day ${todayCycleDay} (${todayPhase})`;
  } else {
    document.getElementById('todayInfo').textContent = `Today is ${today.toDateString()}`;
  }
}
</script>

</body>
</html>
